@model Inmobiliaria10.Models.Usuario

@{
    var claimFoto = User.FindFirst("Foto")?.Value;
    string baseFoto = string.IsNullOrWhiteSpace(claimFoto)
        ? "/img/user.png"
        : "/" + claimFoto.TrimStart('/').Replace("\\", "/").Replace("Uploads", "uploads");

    // cache-buster
    var fotoPerfil = $"{baseFoto}?v={DateTimeOffset.UtcNow.ToUnixTimeSeconds()}";
    ViewData["Title"] = "Mi Perfil";
}

<div class="d-flex justify-content-center mt-5">
  <div class="card shadow-lg p-4 text-center" style="background-color:#d4a437; max-width:400px; width:100%;">
    <h4 class="mb-3">Mi Perfil</h4>

    <img src="@fotoPerfil"
         alt="Avatar" class="rounded-circle mb-3 mx-auto"
         style="width:200px; height:200px; object-fit:cover;" />

    <p class="mb-1"><strong>Nombre completo:</strong> @Model.ApellidoNombres</p>
    <p class="mb-1"><strong>Alias:</strong> @Model.Alias</p>
    <p class="mb-1"><strong>Email:</strong> @Model.Email</p>
    <p class="mb-3"><strong>Rol:</strong> @(Model.Rol?.DenominacionRol ?? "Empleado")</p>

    <div class="d-flex justify-content-center gap-2">
      <a asp-action="PerfilImagen" class="btn btn-warning btn-sm">Cambiar foto</a>
      <a asp-action="PerfilDatos" class="btn btn-dark btn-sm">Editar datos</a>
      <a asp-action="CambiarPassword" class="btn btn-secondary btn-sm">Cambiar contrase√±a</a>
    </div>
  </div>
</div>
